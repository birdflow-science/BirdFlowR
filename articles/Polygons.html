<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculate movement among polygons • BirdFlowR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate movement among polygons">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BirdFlowR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.1.0.9075</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/BirdFlowR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/BirdFlowOverview.html">BirdFlow Model Overview, Uses, and Limitations</a></li>
    <li><a class="dropdown-item" href="../articles/Installation.html">Detailed installation instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Polygons.html">Calculate movement among polygons</a></li>
    <li><a class="dropdown-item" href="../articles/Preprocess.html">Preprocess and sparsify</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/birdflow-science/BirdFlowR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate movement among polygons</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/birdflow-science/BirdFlowR/blob/main/vignettes/Polygons.Rmd" class="external-link"><code>vignettes/Polygons.Rmd</code></a></small>
      <div class="d-none name"><code>Polygons.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal here is to estimate movement among polygons over a defined
period of time using a BirdFlow model. The result is square movement
matrix where the rows correspond to starting polygons and the columns to
ending polygons. Values are the proportion of the total population
making each movement, which<br>
can be scaled to represent numbers of birds. Optionally each value can
be adjusted by the area of the two associated polygons to get a mean
movement per square km.</p>
<p>The initial use case was to create a predictor for a model of avian
influenza spread. In the example here the polygons are US States but the
variable (<code>polys</code>) and the sole required column name
(<code>id</code>) are kept deliberately generic so the code will make
sense with any set of polygons.</p>
<p>This will likely be turned into a function but the vignette should
remain a useful demonstration of how to work with BirdFlow models.</p>
<div class="section level3">
<h3 id="the-approach">The approach:<a class="anchor" aria-label="anchor" href="#the-approach"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Load model, set start and end times for connectivity window, and set
total population.</li>
<li>Download and prepare polygons</li>
<li>Calculate the overlap between active cells in the BirdFlow model and
the polygons.</li>
<li>Generate starting distributions for each polygon that represent the
portion of the species distribution that is in each polygon at the start
of the movement.</li>
<li>Run <code><a href="../reference/predict.BirdFlow.html">predict()</a></code> using distributions and start and end
time.</li>
<li>Drop time dimension from result preserving just the end
distributions.</li>
<li>Convert the ending distribution from model cells to polygons.</li>
<li>Optionally, multiply by the species’ total population (within the
Americas) to convert from proportion of population to estimated number
of birds</li>
<li>Optionally, divide by the area of both the starting and ending state
to make the estimates per unit area - eliminating the polygon size as a
factor in the connectivity. This step is not appropriate for all use
cases.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="load-model-and-set-parameters">Load model and set parameters<a class="anchor" aria-label="anchor" href="#load-model-and-set-parameters"></a>
</h2>
<p>This example uses the American Woodcock dataset from
<strong>BirdFlowModels</strong> which is small and runs fast but isn’t
fully vetted for scientific use.</p>
<p>Use <code><a href="../reference/load_model.html">load_model()</a></code> for real work.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowModels</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BirdFlowModels/man/BirdFlowModels.html" class="external-link">amewoo</a></span>  <span class="co"># you will likely use load_model() instead</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowR</span><span class="fu">::</span><span class="fu"><a href="../reference/lookup_timestep.html">lookup_timestep</a></span><span class="op">(</span><span class="st">"2024-01-15"</span>, <span class="va">bf</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowR</span><span class="fu">::</span><span class="fu"><a href="../reference/lookup_timestep.html">lookup_timestep</a></span><span class="op">(</span><span class="st">"2024-03-20"</span>, <span class="va">bf</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fl">3500000</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-the-starting-distribution-from-the-model">Visualize the starting distribution from the model<a class="anchor" aria-label="anchor" href="#visualize-the-starting-distribution-from-the-model"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_distr.html">plot_distr</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_distr.html">get_distr</a></span><span class="op">(</span><span class="va">bf</span>, <span class="va">start</span><span class="op">)</span>, <span class="va">bf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Polygons_files/figure-html/plot%20starting%20distribution-1.png" width="65%"></p>
</div>
</div>
<div class="section level2">
<h2 id="load-polygons">Load Polygons<a class="anchor" aria-label="anchor" href="#load-polygons"></a>
</h2>
<p>Use <code><a href="../reference/get_naturalearth.html">get_states()</a></code> to get the state boundaries within
BirdFlow object extent from the<a href="https://www.naturalearthdata.com/" class="external-link">Natural Earth</a> data set.</p>
<p>If you have a polygon shapefile already you could use
<code>polys &lt;- sf::read_sf(shapefile_path)</code> and skip this
section.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  Note this code requires the rnaturalearthhighres package so is not</span></span>
<span><span class="co"># run when building the vignette.</span></span>
<span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_naturalearth.html">get_states</a></span><span class="op">(</span><span class="va">bf</span>, country <span class="op">=</span> <span class="st">"United States of America"</span>,</span>
<span>                    keep_buffer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    keep_attributes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">polys</span>, NAME <span class="op">=</span> <span class="va">gn_name</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-polygons-for-analysis">Prepare polygons for analysis<a class="anchor" aria-label="anchor" href="#prepare-polygons-for-analysis"></a>
</h2>
<ul>
<li>Add an <code>id</code> field; in this example it is the state
names.</li>
<li>Transform to match the BirdFlow Coordinate Reference System
(CRS).</li>
<li>Calculate the area in square kilometers of each polygon
(<code>sq_km</code>).</li>
<li>Add centroid coordinates (<code>x</code>, <code>y</code>) in the
BirdFlow CRS.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Add generic "id" column (use state name)</span></span>
<span><span class="va">polys</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">$</span><span class="va">NAME</span></span>
<span></span>
<span><span class="co"># Order by id (optional)</span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Transform to match the BirdFlow model CRS</span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">polys</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add sq_km to polygons</span></span>
<span><span class="co"># This assumes the projection is in meters which is true for BirdFlow models</span></span>
<span><span class="va">polys</span><span class="op">$</span><span class="va">sq_km</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span>  <span class="op">/</span> <span class="fl">1000</span><span class="op">^</span><span class="fl">2</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add centroids (only used for the plotting at end of document)</span></span>
<span><span class="va">centroids</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">polys</span><span class="op">[</span>, <span class="st">"geometry"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">centroids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">polys</span>, <span class="va">centroids</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-overlap-between-active-birdflow-cells-and-polygons">Calculate overlap between active BirdFlow cells and polygons<a class="anchor" aria-label="anchor" href="#calculate-overlap-between-active-birdflow-cells-and-polygons"></a>
</h2>
<p>Make the <code>overlap</code> matrix. Rows correspond to active
cells, and columns to the external polygons. The values are the
proportion of the cell that overlaps the polygon.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Convert active cells to polygons</span></span>
<span><span class="va">cell_polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rasterize.html">rasterize_distr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimensions.html">n_active</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span><span class="op">)</span>, <span class="va">bf</span>, format <span class="op">=</span> <span class="st">"terra"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.polygons.html" class="external-link">as.polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cell_polys</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"i"</span> <span class="co"># BirdFlow location index "i"</span></span>
<span></span>
<span><span class="co"># Intersect cells with polygons</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span> <span class="co"># Attribute values assumed to be spatially constant...</span></span>
<span>  <span class="va">intersection_polys</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">cell_polys</span>, <span class="va">polys</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">intersection_polys</span> <span class="op">&lt;-</span> <span class="va">intersection_polys</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"id"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">intersection_polys</span><span class="op">)</span></span>
<span><span class="va">sq_m_per_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">prop_of_cell</span> <span class="op">&lt;-</span> <span class="va">intersection_polys</span><span class="op">$</span><span class="va">area</span> <span class="op">/</span> <span class="va">sq_m_per_cell</span></span>
<span></span>
<span><span class="co"># Calculate the proportion of each cell that overlaps each polygon</span></span>
<span><span class="co"># Rows = active cells, columns = polygons</span></span>
<span><span class="va">overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="../reference/dimensions.html">n_active</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="../reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span>,</span>
<span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimensions.html">n_active</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  id <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimensions.html">n_active</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">intersection_polys</span><span class="op">$</span><span class="va">id</span>, <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">row_col_index</span> <span class="op">&lt;-</span> <span class="va">intersection_polys</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">overlap</span><span class="op">[</span><span class="va">row_col_index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">intersection_polys</span><span class="op">$</span><span class="va">prop_of_cell</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-initial-distributions">Build initial distributions<a class="anchor" aria-label="anchor" href="#build-initial-distributions"></a>
</h2>
<p>This essentially clips the initial distribution separately to each
polygon while assigning values from boundary cells in proportion to
their overlap with the polygon.</p>
<p>Note, a single BirdFlowR distribution is a vector of length
<code>n_active(bf)</code> multiple can be stored in a matrix with
<code>n_active(bf)</code> rows. The matrix here has a column
(distribution) for each polygon in <code>polys</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">start_distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_distr.html">get_distr</a></span><span class="op">(</span><span class="va">bf</span>, <span class="va">start</span><span class="op">)</span>,</span>
<span>                              nrow <span class="op">=</span> <span class="fu"><a href="../reference/dimensions.html">n_active</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span>,</span>
<span>                              ncol <span class="op">=</span> <span class="fu"><a href="../reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span>,</span>
<span>                              byrow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                             start_poly <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">start_distr</span> <span class="op">&lt;-</span> <span class="va">start_distr</span> <span class="op">*</span> <span class="va">overlap</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-the-distribution-for-one-polygon">Visualize the distribution for one polygon<a class="anchor" aria-label="anchor" href="#visualize-the-distribution-for-one-polygon"></a>
</h3>
<p>Visualize the initial distribution for the polygon with the highest
initial abundance (North Carolina).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">start_distr</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_distr.html">plot_distr</a></span><span class="op">(</span><span class="va">start_distr</span>, <span class="va">bf</span>, subset <span class="op">=</span> <span class="va">sel</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">polys</span>,</span>
<span>                   inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="Polygons_files/figure-html/visualize%20largest%20distribution-1.png" width="65%"></p>
</div>
</div>
<div class="section level2">
<h2 id="project-the-distributions-forward">Project the distributions forward<a class="anchor" aria-label="anchor" href="#project-the-distributions-forward"></a>
</h2>
<p>Use <code><a href="../reference/predict.BirdFlow.html">BirdFlowR::predict()</a></code> to project the distributions
forward. With multiple input distributions the output will be a three
dimensional array. Select the last element of the third dimension to get
just the ending distributions in a matrix. The values in these
distributions represent the proportion of the population that started in
the corresponding polygon (columns) that ended in each active cell
(rows).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Project distributions forward to end date</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.BirdFlow.html">predict</a></span><span class="op">(</span><span class="va">bf</span>, distr <span class="op">=</span> <span class="va">start_distr</span>, start <span class="op">=</span> <span class="va">start</span>, end <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Just keep last distribution</span></span>
<span><span class="va">end_distr</span> <span class="op">&lt;-</span> <span class="va">pred</span><span class="op">[</span>, , <span class="fu"><a href="../reference/dimensions.html">dim</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Preserve dimension names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">end_distr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">start_distr</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-the-ending-distribution">Visualize the ending distribution<a class="anchor" aria-label="anchor" href="#visualize-the-ending-distribution"></a>
</h3>
<p>This shows the ending distribution for the birds that started in
North Carolina.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_distr.html">plot_distr</a></span><span class="op">(</span><span class="va">end_distr</span>, <span class="va">bf</span>, <span class="va">sel</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">polys</span>,</span>
<span>                   inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="Polygons_files/figure-html/visualize%20ending%20distribution-1.png" width="65%"></p>
</div>
</div>
<div class="section level2">
<h2 id="collapse-the-ending-cells-into-ending-polygons">Collapse the ending cells into ending polygons<a class="anchor" aria-label="anchor" href="#collapse-the-ending-cells-into-ending-polygons"></a>
</h2>
<p>Convert the <code>end_distr</code> destination cells into destination
polygons based on the overlap proportions in <code>overlap</code>.</p>
<p>The first “slow” way is perhaps easier to understand. The faster way
produces the same result with matrix multiplication. Either way
<code>move</code> is a matrix with rows for the starting polygons,
columns for the destination polygons, and values that are the proportion
of the population making the transition between the two.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">slow</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Here we loop through each cell of the movement matrix filling in values</span></span>
<span>  <span class="co"># one by one.</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span></span>
<span>  <span class="va">move</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span>, <span class="va">n</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span>, to <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">from_i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">to_i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Rows are source polygons, columns for destination polygons.</span></span>
<span>    <span class="co"># Values are the proportion of the total population making the transition</span></span>
<span>    <span class="co"># between the corresponding polygons.</span></span>
<span>    <span class="va">move</span><span class="op">[</span><span class="va">from_i</span>, <span class="va">to_i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">end_distr</span><span class="op">[</span>, <span class="va">from_i</span><span class="op">]</span> <span class="op">*</span> <span class="va">overlap</span><span class="op">[</span>, <span class="va">to_i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Use matrix multiplication to do the same thing faster</span></span>
<span>  <span class="va">move</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/transpose.html" class="external-link">t</a></span><span class="op">(</span><span class="va">end_distr</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">overlap</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">move</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span>, to <span class="op">=</span> <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-the-polygonized-end-distribution">Visualize the polygonized end distribution<a class="anchor" aria-label="anchor" href="#visualize-the-polygonized-end-distribution"></a>
</h3>
<p>Plot the proportion of the total population that moved from<br>
North Carolina to each each state.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polys</span><span class="op">$</span><span class="va">Proportion</span>  <span class="op">&lt;-</span> <span class="va">move</span><span class="op">[</span><span class="va">sel</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">gradient_colors</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EDDEA5"</span>, <span class="st">"#FCCE25"</span>, <span class="st">"#FBA238"</span>, <span class="st">"#EE7B51"</span>, <span class="st">"#DA596A"</span>, <span class="st">"#BF3984"</span>,</span>
<span>        <span class="st">"#9D189D"</span>, <span class="st">"#7401A8"</span>, <span class="st">"#48039F"</span>, <span class="st">"#0D0887"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">polys</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="va">gradient_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/species_info.html">species</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span>, <span class="st">" movement from "</span>, <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                   subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/lookup_date.html">lookup_date</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">bf</span><span class="op">)</span>, <span class="st">" to "</span>,</span>
<span>                                     <span class="fu"><a href="../reference/lookup_date.html">lookup_date</a></span><span class="op">(</span><span class="va">end</span>, <span class="va">bf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Polygons_files/figure-html/visualize%20polygon%20distr-1.png" width="65%"></p>
</div>
</div>
<div class="section level2">
<h2 id="adjust-for-population-optional">Adjust for population (optional)<a class="anchor" aria-label="anchor" href="#adjust-for-population-optional"></a>
</h2>
<p>You can multiply the movement by the total population of the species
to estimated the number of individuals making each movement. This is
likely necessary to aggregate or compare output across species.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to absolute numbers of Birds expected to move between</span></span>
<span><span class="co"># each pair of polygons</span></span>
<span><span class="va">move_count</span>  <span class="op">&lt;-</span> <span class="va">move</span> <span class="op">*</span> <span class="va">population</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adjust-for-area-optional">Adjust for area (optional)<a class="anchor" aria-label="anchor" href="#adjust-for-area-optional"></a>
</h2>
<p>Adjusting for area might be appropriate depending on the application.
If the goal is to capture the total magnitude of movement between each
source and destination polygon than do not adjust for area.</p>
<p>However, in our initial use case our points were in the specified
states but did not represent the entire state so failing to adjust for
state area would introduce a bias - essentially inflating movement for
points that fell in bigger states. Similarly if you want an average per
unit area movement between states that isn’t biased by state area you
would adjust for area.</p>
<p>The adjustment is done by dividing the number of individuals moving
between the two polygons by the area of each polygon in sq km to produce
the expecting number to move between them per sq km at each end.
Clearly, though this does not capture the fine scale variability within
them some of which is captured in the original BirdFlow cells.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Adjust for area if both the source and destination polgons</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span></span>
<span><span class="va">from_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">polys</span><span class="op">$</span><span class="va">sq_km</span>, <span class="va">n</span>, <span class="va">n</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">to_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">polys</span><span class="op">$</span><span class="va">sq_km</span>, <span class="va">n</span>, <span class="va">n</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">move_area</span> <span class="op">&lt;-</span> <span class="va">move_count</span> <span class="op">/</span> <span class="va">from_area</span> <span class="op">/</span> <span class="va">to_area</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-movement">Visualize movement<a class="anchor" aria-label="anchor" href="#visualize-movement"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_count_threshold</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># only plot lines for big movements</span></span></code></pre></div>
<p>Plot non-zero estimated counts of birds moving between polygons and
indicate magnitude with line thickness. Lines are only shown for
movements of at least 1000 individuals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>from <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">polys</span><span class="op">$</span><span class="va">id</span>, times <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                   to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">polys</span><span class="op">$</span><span class="va">id</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                   count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">move_count</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add coordinates of centroids of to and from polygons</span></span>
<span><span class="va">f_mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">long</span><span class="op">$</span><span class="va">from</span>, <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">f_x</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">f_mv</span><span class="op">]</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">f_y</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">f_mv</span><span class="op">]</span></span>
<span><span class="va">t_mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">long</span><span class="op">$</span><span class="va">to</span>, <span class="va">polys</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">t_x</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">t_mv</span><span class="op">]</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">t_y</span> <span class="op">&lt;-</span> <span class="va">polys</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">t_mv</span><span class="op">]</span></span>
<span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="va">long</span><span class="op">[</span><span class="va">long</span><span class="op">$</span><span class="va">count</span> <span class="op">&gt;=</span> <span class="va">plot_count_threshold</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">f_x</span>, y <span class="op">=</span> <span class="va">f_y</span>,</span>
<span>                                     xend <span class="op">=</span> <span class="va">t_x</span>, yend <span class="op">=</span> <span class="va">t_y</span>,</span>
<span>                                     linewidth <span class="op">=</span> <span class="va">count</span><span class="op">)</span>,</span>
<span>                        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linewidth.html" class="external-link">scale_linewidth</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 strip.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">polys</span>,</span>
<span>                   inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="Polygons_files/figure-html/plot%20connections-1.png" width="65%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Plunkett, National Science Foundation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
