<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function calculates the log likelihoods of inferred bird movement
based on two observation points (in time and space). The second point must
have a different timestep (week) than the first, but the location can remain
the same."><title>calculate log likelihoods of observed bird movements — interval_log_likelihood • BirdFlowR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="calculate log likelihoods of observed bird movements — interval_log_likelihood"><meta property="og:description" content="This function calculates the log likelihoods of inferred bird movement
based on two observation points (in time and space). The second point must
have a different timestep (week) than the first, but the location can remain
the same."><meta property="og:image" content="https://birdflow-science.github.io/BirdFlowR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BirdFlowR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.1.0.9035</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/BirdFlowR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BirdFlowOverview.html">BirdFlow Model Overview, Uses, and Limitations</a>
    <a class="dropdown-item" href="../articles/Installation.html">Detailed installation instructions</a>
    <a class="dropdown-item" href="../articles/Preprocess.html">Preprocess and sparsify</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/birdflow-science/BirdFlowR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>calculate log likelihoods of observed bird movements</h1>
      <small class="dont-index">Source: <a href="https://github.com/birdflow-science/BirdFlowR/blob/HEAD/R/interval_log_likelihood.R" class="external-link"><code>R/interval_log_likelihood.R</code></a></small>
      <div class="d-none name"><code>interval_log_likelihood.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates the log likelihoods of inferred bird movement
based on two observation points (in time and space). The second point must
have a different timestep (week) than the first, but the location can remain
the same.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">interval_log_likelihood</span><span class="op">(</span><span class="va">intervals</span>, <span class="va">observations</span>, <span class="va">bf</span>, one_at_a_time <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>intervals</dt>
<dd><p>a data.frame that describes intervals (movements or
stationary periods) for which log likelihood will be calculated by
referencing the <code>id</code> column in <code>observations</code>.</p><dl><dt><code>from</code></dt>
<dd><p>observation id of the starting location and date</p></dd>

<dt> <code>to</code> </dt>
<dd><p>observation id of the ending location and date</p></dd>

<dt> ...  </dt>
<dd><p>any additional columns will be included in the returned
object but not used by this function. It probably should include an
interval ID.</p></dd>


</dl></dd>


<dt>observations</dt>
<dd><p>a data.frame describing observations of birds each row
should be an individual bird, at a location, and date.</p><dl><dt><code>id</code></dt>
<dd><p>Unique observation identifier</p></dd>

<dt><code>lon</code> , <code>lat</code></dt>
<dd><p>longitude and latitude of observation in WGS84
(EPSG:4326)</p></dd>

<dt> <code>date</code></dt>
<dd><p>date associated with observation. See <code><a href="lookup_timestep.html">lookup_timestep()</a></code> for
valid formats.</p></dd>

<dt> ... </dt>
<dd><p>Other columns allowed, but will be ignored.</p></dd>


</dl></dd>


<dt>bf</dt>
<dd><p>a BirdFlow object</p></dd>


<dt>one_at_a_time</dt>
<dd><p>Mainly here for debugging. If FALSE, the default, then
all intervals that start at the same timestep are processed together,
otherwise each interval is processed separately. Results should be identical,
TRUE uses less memory but is slower.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The intervals table is returned  along with new columns:</p>
<dl><dt>log_likelihood </dt>
<dd><p>The model derived log likelihood of the interval</p></dd>

<dt> null_ll </dt>
<dd><p>the log likelihood of the interval based on a null model
that assumes the eBird S&amp;T distribution for the species at the end point</p></dd>

<dt> lag </dt>
<dd><p>the number of timesteps (likely weeks) between the start and
end of the interval</p></dd>

<dt>  exclude </dt>
<dd><p>TRUE if the log likelihood couldn't be calculated for
the interval, in which case there should also be a TRUE in one of the
remaining columns indicating why.</p></dd>

<dt> not_active </dt>
<dd><p>If TRUE the start or end point is not within the model
mask</p></dd>

<dt> dynamic_mask </dt>
<dd><p>If TRUE ebirds S&amp;T has assigned zero probability to
the the start or end point for the associated date and therefore it is
excluded by the dynamic mask or state based sparsification</p></dd>

<dt> sparse </dt>
<dd><p>TRUE if the model assigned zero probability to the interval
and it wasn't due to any of the other reasons. This is likely due to
sparsification eliminating all possible routes between the start and
end point.</p></dd>

<dt> same_timestep </dt>
<dd><p>TRUE if the start and end timesteps are the same, a
lag of zero</p></dd>

<dt> bad_date </dt>
<dd><p>TRUE if the date couldn't be parsed, or if <code>bf</code> is a
partial model and the date falls in the uncovered portion of the year</p></dd>


</dl><p>The returned table rows will have a 1:1 correspondence with the input
<code>intervals</code> table.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The core of this function is calling <code><a href="predict.BirdFlow.html">predict()</a></code> on a distribution that has
the starting location hot (value of 1) and all other locations zero and then
extracting the probability of the ending week and location. The
log of this probability is returned in the <code>log_likelihood</code> column. The null
model assumes that the ebird S&amp;T distribution and thus the <code>null_ll</code> column
contains the log of the probability density from the S&amp;T distribution
at the ending week and location.</p>
<p>The observations and intervals are separated into two tables to allow
flexibility in assigning and evaluating intervals.  With tracking data in
which the frequency of observations is much greater than the weekly S&amp;T data
there are a lot of choices to be made and this function leaves those
decisions to the user.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowModels</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BirdFlowModels/man/BirdFlowModels.html" class="external-link">rewbla</a></span></span></span>
<span class="r-in"><span><span class="va">observations</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowModels</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BirdFlowModels/man/rewbla_banding_data.html" class="external-link">rewbla_observations</a></span></span></span>
<span class="r-in"><span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="fu">BirdFlowModels</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BirdFlowModels/man/rewbla_banding_data.html" class="external-link">rewbla_intervals</a></span></span></span>
<span class="r-in"><span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="va">intervals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="op">]</span> <span class="co"># toy example</span></span></span>
<span class="r-in"><span><span class="va">intervals</span>  <span class="op">&lt;-</span> <span class="fu">interval_log_likelihood</span><span class="op">(</span><span class="va">intervals</span>, <span class="va">observations</span>, <span class="va">bf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">intervals</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           bird_id  from    to interval_id log_likelihood   null_ll lag exclude</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017 B19221769152  2223  2224        1017      -3.157935 -4.453952  47   FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4775 B77724064244 10149 10150        4775      -3.429942 -4.870969  50   FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2177 B29252852992  4625  4626        2177      -5.135462 -5.816720  21   FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      not_active dynamic_mask sparse same_timestep bad_date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017      FALSE        FALSE  FALSE         FALSE    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4775      FALSE        FALSE  FALSE         FALSE    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2177      FALSE        FALSE  FALSE         FALSE    FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ethan Plunkett, Daniel Sheldon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

